{
  "$schema": "./AuthContract.json",
  "$comment": "Valores default para quando o usuário responder 'não sei' ou não responder",
  
  "credentials": {
    "identifier": {
      "field": "email",
      "label": "Email",
      "validation": "email_format"
    },
    "password": {
      "field": "password",
      "label": "Senha",
      "minLength": 8,
      "requireNumber": true,
      "requireSpecial": false,
      "requireUppercase": false
    }
  },
  
  "passwordPolicy": {
    "strength": "medium",
    "rules": {
      "minLength": 8,
      "requireNumber": true,
      "requireUppercase": false,
      "requireLowercase": false,
      "requireSpecial": false,
      "maxLength": 128,
      "noSpaces": true
    },
    "showStrengthIndicator": true,
    "strengthIndicatorType": "bar"
  },
  
  "passwordUI": {
    "showToggle": true,
    "toggleIcon": "eye",
    "confirmOnRegister": true,
    "confirmOnChange": true
  },
  
  "session": {
    "duration": {
      "default": "24h",
      "rememberMe": "30d"
    },
    "storage": "httpOnly_cookie",
    "renewal": "sliding",
    "concurrentSessions": {
      "allowed": true,
      "maxDevices": null
    }
  },
  
  "security": {
    "bruteForce": {
      "enabled": true,
      "maxAttempts": 5,
      "lockoutDuration": "15m",
      "countWindow": "1h"
    },
    "captcha": {
      "enabled": false,
      "showAfterAttempts": 3,
      "provider": "recaptcha"
    },
    "rateLimiting": {
      "login": {
        "requests": 10,
        "window": "1m"
      },
      "passwordReset": {
        "requests": 3,
        "window": "1h"
      }
    }
  },
  
  "messages": {
    "login": {
      "error": {
        "invalidCredentials": "Email ou senha incorretos",
        "accountLocked": "Conta bloqueada temporariamente. Tente novamente em {minutes} minutos.",
        "accountDisabled": "Conta desativada. Entre em contato com o suporte.",
        "emailNotVerified": "Por favor, verifique seu email antes de fazer login."
      },
      "success": null
    },
    "register": {
      "error": {
        "emailExists": "Este email já está cadastrado",
        "weakPassword": "A senha não atende aos requisitos mínimos",
        "invalidData": "Por favor, verifique os dados informados"
      },
      "success": "Cadastro realizado! Verifique seu email para ativar a conta."
    },
    "passwordReset": {
      "request": {
        "success": "Se o email estiver cadastrado, você receberá as instruções em breve.",
        "error": "Não foi possível processar sua solicitação. Tente novamente."
      },
      "confirm": {
        "success": "Senha alterada com sucesso! Faça login com a nova senha.",
        "error": {
          "invalidToken": "Link inválido ou expirado. Solicite um novo.",
          "samePassword": "A nova senha não pode ser igual à anterior."
        }
      }
    },
    "logout": {
      "success": "Você saiu da sua conta."
    }
  },
  
  "redirects": {
    "afterLogin": {
      "default": "/dashboard",
      "fallback": "/",
      "useIntended": true
    },
    "afterLogout": {
      "default": "/login"
    },
    "afterRegister": {
      "emailVerificationRequired": "/verify-email",
      "autoLogin": "/dashboard"
    },
    "afterPasswordReset": {
      "default": "/login"
    },
    "unauthenticated": {
      "default": "/login",
      "saveIntended": true
    }
  },
  
  "emailVerification": {
    "required": true,
    "allowLimitedAccess": true,
    "tokenExpiration": "24h",
    "resendCooldown": "1m"
  },
  
  "rememberMe": {
    "enabled": true,
    "label": "Lembrar-me",
    "defaultChecked": false,
    "duration": "30d"
  },
  
  "socialLogin": {
    "enabled": false,
    "providers": [],
    "allowAccountLinking": true,
    "canCreateAccountWithoutPassword": true
  },
  
  "twoFactor": {
    "enabled": false,
    "required": false,
    "methods": ["totp"],
    "recoveryCodesCount": 10
  },
  
  "byFlowType": {
    "login": {
      "fields": ["email", "password"],
      "rememberMe": true,
      "forgotPasswordLink": true,
      "registerLink": true,
      "submitLabel": "Entrar"
    },
    "register": {
      "fields": ["name", "email", "password", "confirmPassword"],
      "termsAcceptance": {
        "required": true,
        "label": "Li e aceito os Termos de Uso e Política de Privacidade"
      },
      "loginLink": true,
      "submitLabel": "Cadastrar"
    },
    "passwordResetRequest": {
      "fields": ["email"],
      "submitLabel": "Enviar instruções",
      "backToLoginLink": true
    },
    "passwordResetConfirm": {
      "fields": ["password", "confirmPassword"],
      "submitLabel": "Definir nova senha",
      "showRequirements": true
    },
    "changePassword": {
      "fields": ["currentPassword", "newPassword", "confirmPassword"],
      "submitLabel": "Alterar senha",
      "requireCurrentPassword": true
    }
  },
  
  "formLabels": {
    "email": "Email",
    "password": "Senha",
    "confirmPassword": "Confirmar senha",
    "currentPassword": "Senha atual",
    "newPassword": "Nova senha",
    "name": "Nome completo",
    "phone": "Telefone",
    "rememberMe": "Lembrar-me",
    "forgotPassword": "Esqueceu a senha?",
    "login": "Entrar",
    "register": "Cadastrar",
    "logout": "Sair",
    "alreadyHaveAccount": "Já tem uma conta?",
    "dontHaveAccount": "Não tem uma conta?"
  },
  
  "testDefaults": {
    "login": {
      "happyPath": [
        "logs in with valid credentials",
        "redirects to dashboard after login",
        "stores session correctly",
        "remember me extends session"
      ],
      "sadPath": [
        "shows error for invalid email",
        "shows error for wrong password",
        "locks account after max attempts",
        "prevents login with unverified email"
      ]
    },
    "register": {
      "happyPath": [
        "creates account with valid data",
        "sends verification email",
        "shows success message"
      ],
      "sadPath": [
        "shows error for existing email",
        "shows error for weak password",
        "shows error for password mismatch",
        "requires terms acceptance"
      ]
    },
    "logout": {
      "happyPath": [
        "clears session",
        "redirects to login page",
        "cannot access protected routes after logout"
      ]
    },
    "passwordReset": {
      "happyPath": [
        "sends reset email for valid account",
        "allows password reset with valid token",
        "invalidates token after use"
      ],
      "sadPath": [
        "shows same message for invalid email (security)",
        "rejects expired token",
        "rejects already used token"
      ]
    }
  }
}
