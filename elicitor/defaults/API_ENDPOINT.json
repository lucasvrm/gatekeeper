{
  "$schema": "./APIEndpointContract.json",
  "$comment": "Valores default para quando o usuário responder 'não sei' ou não responder",
  
  "authentication": {
    "required": true,
    "type": "bearer",
    "description": "Requer autenticação por padrão"
  },
  
  "authorization": {
    "checkOwnership": true,
    "description": "Verifica se usuário tem acesso ao recurso específico"
  },
  
  "request": {
    "contentType": "application/json",
    "maxBodySize": "1mb"
  },
  
  "response": {
    "contentType": "application/json",
    "envelope": {
      "success": {
        "format": {
          "data": "{{payload}}",
          "meta": "{{pagination_if_list}}"
        }
      },
      "error": {
        "format": {
          "error": {
            "code": "{{ERROR_CODE}}",
            "message": "{{Human readable message}}"
          }
        }
      }
    }
  },
  
  "pagination": {
    "enabled": "for_lists",
    "defaultLimit": 20,
    "maxLimit": 100,
    "style": "offset",
    "params": {
      "page": "page",
      "limit": "limit"
    },
    "response": {
      "total": "total",
      "page": "page",
      "limit": "limit",
      "totalPages": "totalPages"
    }
  },
  
  "errors": {
    "validation": {
      "status": 400,
      "code": "VALIDATION_ERROR",
      "message": "Dados inválidos"
    },
    "unauthorized": {
      "status": 401,
      "code": "UNAUTHORIZED",
      "message": "Não autenticado"
    },
    "forbidden": {
      "status": 403,
      "code": "FORBIDDEN",
      "message": "Sem permissão"
    },
    "notFound": {
      "status": 404,
      "code": "NOT_FOUND",
      "message": "Recurso não encontrado"
    },
    "conflict": {
      "status": 409,
      "code": "CONFLICT",
      "message": "Recurso já existe"
    },
    "rateLimit": {
      "status": 429,
      "code": "RATE_LIMIT_EXCEEDED",
      "message": "Muitas requisições"
    },
    "internal": {
      "status": 500,
      "code": "INTERNAL_ERROR",
      "message": "Erro interno do servidor"
    }
  },
  
  "byOperation": {
    "GET_ONE": {
      "method": "GET",
      "path": "/api/{resource}/{id}",
      "successStatus": 200,
      "returns": "full_resource",
      "defaultErrors": ["notFound", "unauthorized", "forbidden"]
    },
    "GET_LIST": {
      "method": "GET",
      "path": "/api/{resource}",
      "successStatus": 200,
      "returns": "array_with_pagination",
      "defaultErrors": ["unauthorized"],
      "pagination": true
    },
    "CREATE": {
      "method": "POST",
      "path": "/api/{resource}",
      "successStatus": 201,
      "returns": "created_resource",
      "defaultErrors": ["validation", "unauthorized", "forbidden", "conflict"]
    },
    "UPDATE_FULL": {
      "method": "PUT",
      "path": "/api/{resource}/{id}",
      "successStatus": 200,
      "returns": "updated_resource",
      "defaultErrors": ["validation", "notFound", "unauthorized", "forbidden"]
    },
    "UPDATE_PARTIAL": {
      "method": "PATCH",
      "path": "/api/{resource}/{id}",
      "successStatus": 200,
      "returns": "updated_resource",
      "defaultErrors": ["validation", "notFound", "unauthorized", "forbidden"]
    },
    "DELETE": {
      "method": "DELETE",
      "path": "/api/{resource}/{id}",
      "successStatus": 204,
      "returns": "none",
      "defaultErrors": ["notFound", "unauthorized", "forbidden"]
    }
  },
  
  "validation": {
    "byFieldType": {
      "email": {
        "format": "email",
        "maxLength": 255
      },
      "phone": {
        "pattern": "^[0-9]{10,11}$",
        "message": "Telefone deve ter 10 ou 11 dígitos"
      },
      "cpf": {
        "pattern": "^[0-9]{11}$",
        "custom": "cpf_validator"
      },
      "cnpj": {
        "pattern": "^[0-9]{14}$",
        "custom": "cnpj_validator"
      },
      "url": {
        "format": "uri"
      },
      "date": {
        "format": "date"
      },
      "datetime": {
        "format": "date-time"
      },
      "money": {
        "type": "number",
        "minimum": 0
      },
      "string": {
        "maxLength": 1000
      }
    }
  },
  
  "rateLimit": {
    "enabled": false,
    "defaultLimits": {
      "authenticated": {
        "requests": 1000,
        "window": "1h"
      },
      "public": {
        "requests": 100,
        "window": "1h"
      }
    }
  },
  
  "softDelete": {
    "enabled": true,
    "field": "deletedAt",
    "excludeFromQueries": true
  },
  
  "timestamps": {
    "createdAt": true,
    "updatedAt": true,
    "format": "ISO8601"
  },
  
  "testDefaults": {
    "assertions": [
      "returns correct status code",
      "returns correct content-type",
      "response matches schema"
    ],
    "happyPath": [
      "authenticated user can perform operation",
      "returns expected data structure"
    ],
    "sadPath": [
      "returns 401 without auth token",
      "returns 403 without permission",
      "returns 404 for non-existent resource",
      "returns 400 for invalid data"
    ],
    "edgeCases": [
      "handles empty body gracefully",
      "handles malformed JSON",
      "handles very long strings"
    ]
  }
}
